resources:
  jobs:
    ingest_bronze:
      name: ingest_bronze

      job_clusters:
        - job_cluster_key: "bronze_cluster"
          new_cluster:
            spark_version: "17.2.x-scala2.13"
            node_type_id: "Standard_DS3_v2"
            num_workers: 0
            autotermination_minutes: 20
            spark_conf:
              spark.databricks.cluster.profile: singleNode
              spark.master: local[*]
            spark_env_vars:
              target_catalog: ${bundle.target}
            custom_tags:
              ResourceClass: SingleNode
            data_security_mode: "SINGLE_USER"
      tasks:
        - task_key: ingest_demographics
          spark_python_task:
            python_file: "../../src/bronze/ingest_demographics.py"
          job_cluster_key: "bronze_cluster"
        - task_key: ingest_drug
          spark_python_task:
          python_file: "../../src/bronze/ingest_drug_details.py"
          job_cluster_key: "bronze_cluster"
        - task_key: ingest_indication
          spark_python_task:
            python_file: "../../src/bronze/ingest_indications.py"
          job_cluster_key: "bronze_cluster"
        - task_key: ingest_outcomes
          spark_python_task:
            python_file: "../../src/bronze/ingest_outcomes.py"
          job_cluster_key: "bronze_cluster"
        - task_key: ingest_reactions
          spark_python_task:
            python_file: "../../src/bronze/ingest_reactions.py"
          job_cluster_key: "bronze_cluster"
        - task_key: ingest_reports
          spark_python_task:
            python_file: "../../src/bronze/ingest_reports.py"
          job_cluster_key: "bronze_cluster"
        - task_key: ingest_therapy_dates
          spark_python_task:
            python_file: "../../src/bronze/ingest_therapy_dates.py"
          job_cluster_key: "bronze_cluster"
